---
title: "Lab 5"
author: "Robert Cervantes"
date: "`r Sys.Date()`"
output: 
  html_document:
    toc: yes
    toc_float: yes
    theme: spacelab
    highlight: pygments
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Tasks

These are the tasks for lab 5

## Task 1

Get Working directory

```{r}
getwd()
```


## Task 2
```{r}
library(Intro2R)
library(dplyr)

# code from lab5.r
mybin=function(iter=100,n=10, p=0.5){ 
  
  # make a matrix to hold the samples
  #initially filled with NA's
  sam.mat=matrix(NA,nr=n,nc=iter, byrow=TRUE)
  
  #Make a vector to hold the number of successes in each trial
  succ=c()
  
  for( i in 1:iter){
    
    #Fill each column with a new sample
    sam.mat[,i]=sample(c(1,0),n,replace=TRUE, prob=c(p,1-p))
    
    #Calculate a statistic from the sample (this case it is the sum)
    succ[i]=sum(sam.mat[,i])
    
  }
  
  #Make a table of successes
  succ.tab=table(factor(succ,levels=0:n))
  
  #Make a barplot of the proportions
  barplot(succ.tab/(iter), col=rainbow(n+1), main="Binomial simulation", xlab="Number of successes")
  succ.tab/iter

}
  
  
myhyper=function(iter=100,N=20,r=12,n=5){
  
  # make a matrix to hold the samples
  #initially filled with NA's
  sam.mat=matrix(NA,nr=n,nc=iter, byrow=TRUE)
  
  #Make a vector to hold the number of successes over the trials
  succ=c()
  
  for( i in 1:iter){
    
    #Fill each column with a new sample
    sam.mat[,i]=sample(rep(c(1,0),c(r,N-r)),n,replace=FALSE)
    
    #Calculate a statistic from the sample (this case it is the sum)
    succ[i]=sum(sam.mat[,i])
    
  }
  
  #Make a table of successes
  succ.tab=table(factor(succ,levels=0:n))
  
  #Make a barplot of the proportions
  barplot(succ.tab/(iter), col=rainbow(n+1), main="HYPERGEOMETRIC simulation", xlab="Number of successes")
  succ.tab/iter
  
}

mysample=function(n, iter=10,time=0.5){
  
  for( i in 1:iter){
    
    #make a sample
    s=sample(1:10,n,replace=TRUE)
    
    # turn the sample into a factor
    sf=factor(s,levels=1:10)
    
    #make a barplot
    barplot(table(sf)/n,
            beside=TRUE,
            col=rainbow(10), 
            main=paste("Example sample()", " iteration ", i, " n= ", n,sep="") ,
            ylim=c(0,0.2)
           )
    
    #release the table
    Sys.sleep(time)
    
  }
  
}

```

```{r}

for (i in c(100, 200, 500, 1000, 10000)) {
  print(mybin(iter=i, n=10, p=0.7))
}

```

## 10000 Iterations
```{r}
## 
##      0      1      2      3      4      5      6      7      8      9     10 
## 0.0001 0.0001 0.0013 0.0094 0.0358 0.1036 0.2002 0.2617 0.2363 0.1227 0.0288
```

```{r}
dbinom(0:10, size=10, prob=0.7)
```


## Task 3

```{r}

# with false
sample(c(rep(1, 12), rep(0, 8)),
       size=5,
       replace=FALSE)

# with true
sample(c(rep(1, 12), rep(0, 8)),
       size=5,
       replace=TRUE)

for (i in c(100, 200, 500, 1000, 10000)) {
  print(myhyper(i, n=5))
}

```

## 10000 Iterations
```{r}
## 
##      0      1      2      3      4      5 
## 0.0038 0.0514 0.2401 0.3887 0.2604 0.0556
```

```{r}
round(dhyper(0:5, 12, 8, 5), 4)
```


## Task 4

The mysample function creates barplots for random elements 1 to 10 with colors. It also has a sleep timer to allow for propogation.

```{r}
#mysample(n=1000, iter=30)
mysample(n=1000, iter=1)
```

The 30 propogated barplots represent the distribution of the random elements 1 to 10. Overall, there seems to be little variance and the distribution is relatively uniform.


## Task 5

```{r}
choose(8, 4)

# poisson distribution, "1 - " because ppois calculates the probability of <=, and we want >
1 - ppois(4, 2)

# negative binomial distribution
dnbinom(10, 3, 0.4) # this one doesnt seem right?(?)

# binomial distribution
pbinom(8, 15, 0.4)
```

## Task 6
```{r}
# Load your installed package
library(MATH4753F25robert)

# Call your function
MATH4753F25robert::mybin(iter=1000, n=10, p=0.5)
```






